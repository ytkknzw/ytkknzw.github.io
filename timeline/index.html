<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
	<meta text="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">  
	<meta text="mobile-web-app-capable" content="yes">
	<meta text="apple-mobile-web-app-title" content="LTX-A" /> 
	<meta text="apple-mobile-web-app-capable" content="yes">
	<meta text="apple-mobile-web-app-status-bar-style" content="black">

	<link rel="manifest" href="manifest.json">

	<link rel="stylesheet" href="../assets/lib/onsenui-2.5.2/css/onsenui.css">
	<link rel="stylesheet" href="../assets/lib/onsenui-2.5.2/css/onsen-css-components.css">
	<style>
	.time {
		box-sizing: border-box;
		height: 30px;
		color: #169;
		font-size: 8px;
		text-align: right;
		padding: 2px 8px;
		border-right: solid 1px #ccf;
	}
	.act {
		margin-left: 48px;
		box-sizing: border-box;
		position: absolute;
		border-radius: 2px;
		padding: 6px;
		font-size: 11px;
		width: calc(100% - 52px - 52px);
		color: #333;
		text-shadow: 2px 2px 5px #999;
	}
	.feel {
		box-sizing: border-box;
		position: absolute;
		right: 6px;
		border-radius: 2px;
		padding: 6px;
		font-size: 13px;
		width: 46px;
		color: #fff;
		text-shadow: 2px 2px 5px #999;
		text-align: center;
	}
	.time:nth-child(even) {
		border-bottom: dotted 1px #ccc;
	}
	.color-circle {
		width: 16px; height: 16px;
		border-radius: 8px;
	}
	.color-circle-in-dlg {
		width: 28px; height: 28px;
		border-radius: 14px;
		float: left;
		margin: 8px;
	}
	.act-btn {
		font-size: 12px;
		padding: 8px;
		border-radius: 14px;
		border-style: none;
		margin: 0 8px;
	}
	#inp-cal {
		background-color: transparent;
		border-style: none;
		position: absolute;
		left: 66px;
		top: 0px;
		height: 52px;
		width: calc(100% - 180px);
		color: transparent;
	}
	</style>

	<script src="../assets/lib/onsenui-2.5.2//js/onsenui.min.js"></script>

	<title>My Timeline</title>
</head>
<body>

<ons-navigator id="myNavigator" page="home.html"></ons-navigator>


<ons-template id="stats.html">
  <ons-page id="stats">
    <ons-toolbar>
      <div class="left"><ons-back-button>Back</ons-back-button></div>
      <div class="center">Stats</div>
      <div class="right">
        <ons-toolbar-button onclick="app.goToPage('setting');">
        	<ons-icon icon="cog"></ons-icon>
        </ons-toolbar-button>
      </div>
    </ons-toolbar>

  </ons-page>
</ons-template>


<ons-template id="home.html">
  <ons-page id="home">
    <ons-toolbar>
      <div class="left">
        <ons-toolbar-button onclick="app.fromTemplate();">
        	<ons-icon icon="navicon"></ons-icon>
        </ons-toolbar-button>
      </div>
      <div class="center">
      	<span id="disp-cal">Aug 18, 2017</span>
      	<input type="date" id="inp-cal" value="" onchange="app.changeDate()">
	  </div>
      <div class="right">
        <ons-toolbar-button onclick="app.goToPage('edit');">
        	<ons-icon icon="pencil"></ons-icon> Edit
        </ons-toolbar-button>
      </div>
    </ons-toolbar>


<ons-gesture-detector>
  <div id="detect-area">
	<div style="height: 64px; border: solid 0px #f00;">
		Aug 12, 2017
	</div>
	<div id="line" style="border: solid 0px #ccc; border-top: double 3px #ccc; border-bottom: double 1px #ccc;">
		<div style="border: solid 0px #0f0; width: 44px;" id="day-line">
			<div class="time">0:00</div><div class="time">0:30</div>
			<div class="time">1:00</div><div class="time">1:30</div>
			<div class="time">2:00</div><div class="time">2:30</div>
			<div class="time">3:00</div><div class="time">3:30</div>
			<div class="time">4:00</div><div class="time">4:30</div>
			<div class="time">5:00</div><div class="time">5:30</div>
			<div class="time">6:00</div><div class="time">6:30</div>
			<div class="time">7:00</div><div class="time">7:30</div>
			<div class="time">8:00</div><div class="time">8:30</div>
			<div class="time">9:00</div><div class="time">9:30</div>
			<div class="time">10:00</div><div class="time">10:30</div>
			<div class="time">11:00</div><div class="time">11:30</div>
			<div class="time">12:00</div><div class="time">12:30</div>
			<div class="time">13:00</div><div class="time">13:30</div>
			<div class="time">14:00</div><div class="time">14:30</div>
			<div class="time">15:00</div><div class="time">15:30</div>
			<div class="time">16:00</div><div class="time">16:30</div>
			<div class="time">17:00</div><div class="time">17:30</div>
			<div class="time">18:00</div><div class="time">18:30</div>
			<div class="time">19:00</div><div class="time">19:30</div>
			<div class="time">20:00</div><div class="time">20:30</div>
			<div class="time">21:00</div><div class="time">21:30</div>
			<div class="time">22:00</div><div class="time">22:30</div>
			<div class="time">23:00</div><div class="time">23:30</div>
		</div>
	</div>
	<div style="height: 256px;"></div>
  </div>
</ons-gesture-detector>

  </ons-page>
</ons-template>


<ons-template id="edit.html">
  <ons-page id="edit">
    <ons-toolbar>
      <div class="left"><ons-back-button>Back</ons-back-button></div>
      <div class="center">Aug 31, 2017</div>
      <div class="right">
        <ons-toolbar-button onclick="nav.popPage();">
        	<ons-icon icon="save"></ons-icon> Save
        </ons-toolbar-button>
      </div>
    </ons-toolbar>

	<div class="list-title">Time</div>
	<ul class="list">
	  <li class="list-item">
	    <div class="list-item__center">Start</div>
	    <div class="list-item__right">
	    	<select name="">
				<option value="0:00">0:00</option><option value="0:30">0:30</option>
				<option value="1:00">1:00</option><option value="1:30">1:30</option>
				<option value="2:00">2:00</option><option value="2:30">2:30</option>
				<option value="3:00">3:00</option><option value="3:30">3:30</option>
				<option value="4:00">4:00</option><option value="4:30">4:30</option>
				<option value="5:00">5:00</option><option value="5:30">5:30</option>
				<option value="6:00">6:00</option><option value="6:30">6:30</option>
				<option value="7:00">7:00</option><option value="7:30">7:30</option>
				<option value="8:00">8:00</option><option value="8:30">8:30</option>
				<option value="9:00">9:00</option><option value="9:30">9:30</option>
				<option value="10:00">10:00</option><option value="10:30">10:30</option>
				<option value="11:00">11:00</option><option value="11:30">11:30</option>
				<option value="12:00">12:00</option><option value="12:30">12:30</option>
				<option value="13:00">13:00</option><option value="13:30">13:30</option>
				<option value="14:00">14:00</option><option value="14:30">14:30</option>
				<option value="15:00">15:00</option><option value="15:30">15:30</option>
				<option value="16:00">16:00</option><option value="16:30">16:30</option>
				<option value="17:00">17:00</option><option value="17:30">17:30</option>
				<option value="18:00">18:00</option><option value="18:30">18:30</option>
				<option value="19:00">19:00</option><option value="19:30">19:30</option>
				<option value="20:00">20:00</option><option value="20:30">20:30</option>
				<option value="21:00">21:00</option><option value="21:30">21:30</option>
				<option value="22:00">22:00</option><option value="22:30">22:30</option>
				<option value="23:00">23:00</option><option value="23:30">23:30</option>
	    	</select>
	    	<!-- <input type="time" value="12:00"> -->
	    </div>
	  </li>
	  <li class="list-item">
	    <div class="list-item__center">End</div>
	    <div class="list-item__right">
	    	<select name="">
				<option value="0:00">0:00</option><option value="0:30">0:30</option>
				<option value="1:00">1:00</option><option value="1:30">1:30</option>
				<option value="2:00">2:00</option><option value="2:30">2:30</option>
				<option value="3:00">3:00</option><option value="3:30">3:30</option>
				<option value="4:00">4:00</option><option value="4:30">4:30</option>
				<option value="5:00">5:00</option><option value="5:30">5:30</option>
				<option value="6:00">6:00</option><option value="6:30">6:30</option>
				<option value="7:00">7:00</option><option value="7:30">7:30</option>
				<option value="8:00">8:00</option><option value="8:30">8:30</option>
				<option value="9:00">9:00</option><option value="9:30">9:30</option>
				<option value="10:00">10:00</option><option value="10:30">10:30</option>
				<option value="11:00">11:00</option><option value="11:30">11:30</option>
				<option value="12:00">12:00</option><option value="12:30">12:30</option>
				<option value="13:00">13:00</option><option value="13:30">13:30</option>
				<option value="14:00">14:00</option><option value="14:30">14:30</option>
				<option value="15:00">15:00</option><option value="15:30">15:30</option>
				<option value="16:00">16:00</option><option value="16:30">16:30</option>
				<option value="17:00">17:00</option><option value="17:30">17:30</option>
				<option value="18:00">18:00</option><option value="18:30">18:30</option>
				<option value="19:00">19:00</option><option value="19:30">19:30</option>
				<option value="20:00">20:00</option><option value="20:30">20:30</option>
				<option value="21:00">21:00</option><option value="21:30">21:30</option>
				<option value="22:00">22:00</option><option value="22:30">22:30</option>
				<option value="23:00">23:00</option><option value="23:30">23:30</option>
			</select>
	    	<!-- <input type="time" value="12:00"> -->
	    </div>
	  </li>
	</ul>
	<div class="list-title">Activity</div>
	<div style="padding: 8px 16px;" id="activity-buttons">
		<button class="button" style="background-color: #ff9999;">aaaa</button>
		<button class="button" style="background-color: #ccccff;">aaaa</button>
	</div>
	  <li class="list-item">
	    <div class="list-item__center">
	      <button class="toolbar-button" style="width: 95%;" onclick="app.goToPage('setting')">
	      	<ons-icon icon="pencil"></ons-icon> 
	      	Edit Activity List
	      </button>
	    </div>
	  </li>
	</ul>
	<div class="list-title">Memo</div>
	<ul class="list">
	  <li class="list-item">
	    <div class="list-item__center">
	      <textarea text="" id="" rows="10" style="width: 100%;"></textarea>
	    </div>
	  </li>
	</ul>
  </ons-page>
</ons-template>


<ons-template id="setting.html">
  <ons-page id="setting">
    <ons-toolbar>
      <div class="left"><ons-back-button>Back</ons-back-button></div>
      <div class="center">Setting</div>
      <div class="right">
        <ons-toolbar-button onclick="app.showDialog('dialog');">
        	<ons-icon icon="plus"></ons-icon> Add
        </ons-toolbar-button>
      </div>
    </ons-toolbar>

	<div class="list-title">Activity</div>
	<div style="padding: 8px" id="">
		<button class="act-btn" style="background-color: #ff0;" onclick="app.showDialog('dialog')">List 0</button>
		<button class="act-btn" style="background-color: #f0f;" onclick="app.showDialog('dialog')">List 1</button>
		<button class="act-btn" style="background-color: #0ff;" onclick="app.showDialog('dialog')">List 2</button>
	</div>

  </ons-page>
</ons-template>


<ons-dialog id="dialog">
  <div class="alert-dialog-container">
	  <div class="alert-dialog-title">アクティビティ</div>
	  <div class="alert-dialog-content">
	  	<p>
	  		<input type="text" class="text-input" style="text-align: center; border-bottom: solid 1px #ccc;" placeholder="activity">
	  	</p>
	  	<div style="padding: 8px 0 0 0;">
	  		<div class="color-circle-in-dlg" style="background-color: #f00;"></div>
	  		<div class="color-circle-in-dlg" style="background-color: #0f0;"></div>
	  		<div class="color-circle-in-dlg" style="background-color: #00f;"></div>
	  		<div class="color-circle-in-dlg" style="background-color: #ff0;"></div>
	  		<div class="color-circle-in-dlg" style="background-color: #f0f;"></div>
	  		<div class="color-circle-in-dlg" style="background-color: #0ff;"></div>
	  		<input type="color" value="#ffffff">
	  	</div>
	  </div>
	  <div class="alert-dialog-footer alert-dialog-footer--rowfooter">
	    <button class="alert-dialog-button alert-dialog-button--rowfooter" onclick="app.hideDialog('dialog')">Cancel</button>
	    <button class="alert-dialog-button alert-dialog-button--rowfooter alert-dialog-button--primal" onclick="app.hideDialog('dialog')">OK</button>
	  </div>
  </div>
</ons-dialog>

<script src="index.js"></script>
<script>
var dat = [
	{ start: '4:00', end: '4:30', activity: 3, memo: '神楽坂ー池袋' },
	{ start: '0:30', end: '0:30', activity: 2, memo: '自' },
	{ start: '1:00', end: '1:30', activity: 7, memo: '' },
	{ start: '2:00', end: '3:00', activity: 5, memo: '教養' },
	{ start: '6:00', end: '10:00', activity: 4, memo: '会社' }
];
var feels = [
	{ start: '4:00', duration: 1.5, value: 2 },
	{ start: '0:30', duration: 0.5, value: 5 },
	{ start: '1:00', duration: 1.0, value: 4 },
	{ start: '2:00', duration: 2.0, value: 3 },
	{ start: '8:00', duration: 2.0, value: 1 },
];
var activity = [
	{ key: 1, text: '睡眠', color: '#ccccff' },
	{ key: 2, text: '食事', color: '#ccffcc' },
	{ key: 3, text: '移動', color: '#ffcccc' },
	{ key: 4, text: '仕事', color: '#9999cc' },
	{ key: 5, text: '読書', color: '#99cc99' },
	{ key: 6, text: 'ジム', color: '#cc9999' },
	{ key: 7, text: 'ゲーム', color: '#9999ff' },
	{ key: 8, text: 'Youtube', color: '#99ff99' },
	{ key: 9, text: '買い物', color: '#ff9999' },
	{ key: 10, text: '日記', color: '#cccccc' }
];
var colors = ['#69c', '#9cf', '#cfc', '#fc6', '#f96'];

document.addEventListener('init', function(event) {
  var page = event.target;

  if (page.id === 'home') {
  	app.showTimeline();
  } else if(page.id === 'edit') {
  	// console.log('init edit', event);
  	app.showEdit(event.target.data);
  } else if(page.id === 'list') {
    page.querySelectorAll('.row').forEach(function(row) {
      row.onclick = function(evt) {
        nav.pushPage('edit.html', {data: {title: 'Page Edit'}});
      };
    });
  } else {
    // page.querySelector('ons-toolbar .center').innerHTML = page.data.title;
  }
});

document.addEventListener('swipeleft', function(event) {
	if (event.target.matches('#detect-area')) {
		console.log('Swipe left is detected.');
	}
});


var nav = document.querySelector('#myNavigator');

var app = {

  goToPage    : function(pageId) { nav.pushPage(pageId + '.html'); },
  showDialog  : function(id) { document.getElementById(id).show(); },
  hideDialog  : function(id) { document.getElementById(id).hide(); },

  fromTemplate : function() {
    var dialog = document.getElementById('dialog-3');
    if (dialog) {
      dialog.show();
    } else {
      ons.createDialog('dialog.html').then(function(dialog) {
        dialog.show();
      });
    }
  },

  changeDate : function() {
  	var val = document.getElementById('inp-cal').value;
  	console.log(val);
  	document.getElementById('disp-cal').innerHTML = val;
  },
  // showCalendar : function() {
  // 	var inpCal = document.getElementById('inp-cal');
  // 	inpCal.focus();
  // 	alert('calender?');
  // 	console.log('focus');
  // },

  showTimeline : function() {
  	var line = document.getElementById('line');
  	dat.forEach(function(d, i) {
  		var act = {};
  		for(var j=0; j<activity.length; j++) {
  			if(d.activity == activity[j].key) {
  				act = activity[j]; break;
  			}
  		}
  		var s = d.start.split(':'),
  			e = d.end.split(':'),
  			h = parseInt(s[0]) * 2 + (s[1]=='00' ? 0 : 1),
  			a = parseInt(e[0]) * 2 + (e[1]=='00' ? 0 : 1),
  			css  = 'height: ' + ((a - h) * 30 - 3) + 'px;';
  			css += 'top: ' + (70 + h * 30) + 'px;';
  			css += 'background-color: ' + act.color + ';',
  			div = document.createElement('div');
  		div.innerHTML = act.text + ' ： ' + d.memo;
  		div.className = 'act';
  		div.style = css;
  		div.onclick = function(e) {
			e.preventDefault();
		    nav.pushPage('edit.html', { data: dat[i] } );
  			// app.showEdit(i);
  		};
  		line.append(div);
  	});
  	feels.forEach(function(d, i) {
  		var s = d.start.split(':'),
  			h = parseInt(s[0]) * 2 + (s[1]=='00' ? 0 : 1),
  			e = d.duration,
  			css  = 'height: ' + (e * 2 * 30 - 3) + 'px;';
  			css += 'top: ' + (70 + h * 30) + 'px;';
  			css += 'background-color: ' + colors[d.value - 1] + ';',
  			div = document.createElement('div');
  		div.innerHTML = d.value;
  		div.className = 'feel';
  		div.style = css;
  		div.onclick = function(e) {
			e.preventDefault();
  		};
  		line.append(div);
  	});
  },

  showEdit : function(data) {
  	console.log('showEdit', data);
  	var h = '';
  	activity.forEach(function(li, i) {
	  h += '<label class="radio-button" style="margin: 8px;">'
		+  '<input type="radio" class="radio-button__input" name="r"' 
		+  (li.key == data.activity ? ' checked' : '' ) + '>'
		+  '<div class="radio-button__checkmark act-btn" style="background-color:' + li.color + '"></div>'
		+  '' +  li.text + '</label>';
  	});
  	document.getElementById('activity-buttons').innerHTML = h;
  }
};

</script>
</body>
</html>